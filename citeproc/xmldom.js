if("undefined"===typeof CSL_IS_IE){var CSL_IS_IE}var CSL_CHROME=function(){if("undefined"==typeof DOMParser||CSL_IS_IE){CSL_IS_IE=true;DOMParser=function(){};DOMParser.prototype.parseFromString=function(f,g){if("undefined"!=typeof ActiveXObject){var e=new ActiveXObject("MSXML.DomDocument");e.async=false;e.loadXML(f);return e}else{if("undefined"!=typeof XMLHttpRequest){var e=new XMLHttpRequest;if(!g){g="text/xml"}e.open("GET","data:"+g+";charset=utf-8,"+encodeURIComponent(f),false);if(e.overrideMimeType){e.overrideMimeType(g)}e.send(null);return e.responseXML}}};this.hasAttributes=function(f){var e;if(f.attributes&&f.attributes.length){e=true}else{e=false}return e}}else{this.hasAttributes=function(f){var e;if(f.attributes&&f.attributes.length){e=true}else{e=false}return e}}this.importNode=function(g,e){if("undefined"==typeof g.importNode){var f=this._importNode(g,e,true)}else{var f=g.importNode(e,true)}return f};this._importNode=function(k,j,e){switch(j.nodeType){case 1:var h=k.createElement(j.nodeName);if(j.attributes&&j.attributes.length>0){for(var g=0,f=j.attributes.length;g<f;){h.setAttribute(j.attributes[g].nodeName,j.getAttribute(j.attributes[g++].nodeName))}}if(e&&j.childNodes&&j.childNodes.length>0){for(var g=0,f=j.childNodes.length;g<f;){h.appendChild(this._importNode(k,j.childNodes[g++],e))}}return h;break;case 3:case 4:case 8:}};this.parser=new DOMParser();var d='<docco><institution institution-parts="long" delimiter=", " substitute-use-first="1" use-last="1"><institution-part name="long"/></institution></docco>';var c=this.parser.parseFromString(d,"text/xml");var b=c.getElementsByTagName("institution");this.institution=b.item(0);var a=c.getElementsByTagName("institution-part");this.institutionpart=a.item(0);this.ns="http://purl.org/net/xbiblio/csl"};CSL_CHROME.prototype.clean=function(a){a=a.replace(/<\?[^?]+\?>/g,"");a=a.replace(/<![^>]+>/g,"");a=a.replace(/^\s+/,"");a=a.replace(/\s+$/,"");a=a.replace(/^\n*/,"");return a};CSL_CHROME.prototype.getStyleId=function(b){var c="";var a=b.getElementsByTagName("id");if(a&&a.length){a=a.item(0)}if(a){c=a.textContent}if(!c){c=a.innerText}if(!c){c=a.innerHTML}return c};CSL_CHROME.prototype.children=function(d){var c,e,a,b;if(d){b=[];c=d.childNodes;for(e=0,a=c.length;e<a;e+=1){if(c[e].nodeName!="#text"){b.push(c[e])}}return b}else{return[]}};CSL_CHROME.prototype.nodename=function(b){var a=b.nodeName;return a};CSL_CHROME.prototype.attributes=function(g){var e,d,b,f,c,h,a;e=new Object();if(g&&this.hasAttributes(g)){d=g.attributes;for(h=0,a=d.length;h<a;h+=1){b=d[h];e["@"+b.name]=b.value}}return e};CSL_CHROME.prototype.content=function(b){var a;if("undefined"!=typeof b.textContent){a=b.textContent}else{if("undefined"!=typeof b.innerText){a=b.innerText}else{a=b.txt}}return a};CSL_CHROME.prototype.namespace={xml:"http://www.w3.org/XML/1998/namespace"};CSL_CHROME.prototype.numberofnodes=function(a){if(a){return a.length}else{return 0}};CSL_CHROME.prototype.getAttributeName=function(a){var b=a.name;return b};CSL_CHROME.prototype.getAttributeValue=function(d,b,c){var a=false;if(c){b=c+":"+b}if(d&&this.hasAttributes(d)){if(d.getAttribute(b)){a=d.getAttribute(b)}}else{a=""}return a};CSL_CHROME.prototype.getNodeValue=function(d,b){var a="";if(b){var c=d.getElementsByTagName(b);if(c.length>0){if("undefined"!=typeof c[0].textContent){a=c[0].textContent}else{if("undefined"!=typeof c[0].innerText){a=c[0].innerText}else{a=c[0].text}}}}else{a=d}if(a&&a.childNodes&&(a.childNodes.length==0||(a.childNodes.length==1&&a.firstChild.nodeName=="#text"))){if("undefined"!=typeof a.textContent){a=a.textContent}else{if("undefined"!=typeof a.innerText){a=a.innerText}else{a=a.text}}}return a};CSL_CHROME.prototype.setAttributeOnNodeIdentifiedByNameAttribute=function(e,f,g,d,b){var j,i,h,a,c;if(d.slice(0,1)==="@"){d=d.slice(1)}a=e.getElementsByTagName(f);for(j=0,i=a.length;j<i;j+=1){c=a[j];if(c.getAttribute("name")!=g){continue}c.setAttribute(d,b)}};CSL_CHROME.prototype.deleteNodeByNameAttribute=function(d,e){var f,a,c,b;b=d.childNodes;for(f=0,a=b.length;f<a;f+=1){c=b[f];if(!c||c.nodeType==c.TEXT_NODE){continue}if(this.hasAttributes(c)&&c.getAttribute("name")==e){d.removeChild(b[f])}}};CSL_CHROME.prototype.deleteAttribute=function(b,a){b.removeAttribute(a)};CSL_CHROME.prototype.setAttribute=function(b,a,c){if(!b.ownerDocument){b=b.firstChild}if(["function","unknown"].indexOf(typeof b.setAttribute)>-1){b.setAttribute(a,c)}return false};CSL_CHROME.prototype.nodeCopy=function(b){var a=b.cloneNode(true);return a};CSL_CHROME.prototype.getNodesByName=function(g,d,f){var c,b,e,h,a;c=[];b=g.getElementsByTagName(d);for(h=0,a=b.length;h<a;h+=1){e=b.item(h);if(f&&!(this.hasAttributes(e)&&e.getAttribute("name")==f)){continue}c.push(e)}return c};CSL_CHROME.prototype.nodeNameIs=function(b,a){if(a==b.nodeName){return true}return false};CSL_CHROME.prototype.makeXml=function(c){var a,b;if(!c){c="<docco><bogus/></docco>"}c=c.replace(/\s*<\?[^>]*\?>\s*\n*/g,"");var d=this.parser.parseFromString(c,"application/xml");return d.firstChild};CSL_CHROME.prototype.insertChildNodeAfter=function(c,d,f,a){var e,b;e=this.importNode(d.ownerDocument,a);c.replaceChild(e,d);return c};CSL_CHROME.prototype.insertPublisherAndPlace=function(h){var o=h.getElementsByTagName("group");for(var l=0,b=o.length;l<b;l+=1){var c=o.item(l);var n=[];for(var f=0,p=c.childNodes.length;f<p;f+=1){if(c.childNodes.item(f).nodeType!==1){n.push(f)}}if(c.childNodes.length-n.length===2){var g=[];for(var f=0,p=2;f<p;f+=1){if(n.indexOf(f)>-1){continue}var a=c.childNodes.item(f);var d=[];for(var e=0,m=a.childNodes.length;e<m;e+=1){if(a.childNodes.item(e).nodeType!==1){d.push(e)}}if(a.childNodes.length-d.length===0){g.push(a.getAttribute("variable"));if(a.getAttribute("suffix")||a.getAttribute("prefix")){g=[];break}}}if(g.indexOf("publisher")>-1&&g.indexOf("publisher-place")>-1){c.setAttribute("has-publisher-and-publisher-place",true)}}}};CSL_CHROME.prototype.addMissingNameNodes=function(h){var b=h.getElementsByTagName("names");for(var e=0,d=b.length;e<d;e+=1){var g=b.item(e);var a=g.getElementsByTagName("name");if((!a||a.length===0)&&g.parentNode.tagName.toLowerCase()!=="substitute"){var f=g.ownerDocument;var c=f.createElement("name");g.appendChild(c)}}};CSL_CHROME.prototype.addInstitutionNodes=function(i){var q,e,d,b,a,c,l,r,n;q=i.getElementsByTagName("names");for(r=0,n=q.length;r<n;r+=1){e=q.item(r);a=e.getElementsByTagName("name");if(a.length==0){continue}d=e.getElementsByTagName("institution");if(d.length==0){b=this.importNode(i.ownerDocument,this.institution);theinstitutionpart=b.getElementsByTagName("institution-part").item(0);c=a.item(0);e.insertBefore(b,c.nextSibling);for(var h=0,s=CSL.INSTITUTION_KEYS.length;h<s;h+=1){var g=CSL.INSTITUTION_KEYS[h];var m=c.getAttribute(g);if(m){theinstitutionpart.setAttribute(g,m)}}var p=c.getElementsByTagName("name-part");for(var h=0,s=p.length;h<s;h+=1){if("family"===p[h].getAttribute("name")){for(var f=0,o=CSL.INSTITUTION_KEYS.length;f<o;f+=1){var g=CSL.INSTITUTION_KEYS[f];var m=p[h].getAttribute(g);if(m){theinstitutionpart.setAttribute(g,m)}}}}}}};CSL_CHROME.prototype.flagDateMacros=function(c){var e,a,b,d;nodes=c.getElementsByTagName("macro");for(e=0,a=nodes.length;e<a;e+=1){b=nodes.item(e);d=b.getElementsByTagName("date");if(d.length){b.setAttribute("macro-has-date","true")}}};